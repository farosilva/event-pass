# Business Rules & Domain Logic

## 1. User Profiles & Permissions
- **ADMIN**:
  - Can create and manage events.
  - Can view the dashboard (Admin Panel).
  - Can perform "Check-in" of users (scan tickets).
- **USER**:
  - Can sign up and login.
  - Can view available events.
  - Can issue tickets (register for events).
  - Can view their own tickets.

## 2. Registration Rules (Ticket Issuance)
- **Uniqueness**: A User can register for a specific Event ONCE.
  - *Implementation*: Unique Constraint in the database `(userId, eventId)`.
- **Atomicity**: Registration must be atomic.
  - *Flow*: `Start Transaction` -> `Check Available Spots` -> `Insert Ticket` -> `Decrement Spots` -> `Commit`.
  - If seats < 1, throw error and Rollback.
- **Identifier**: The QR Code generation must be based on the unique Ticket ID or signed hash.
- **QR Code format**: The QR Code must be in JWT format and signed with a secret key. The JWT must contain the following information:
  - `ticketId`
  - `userId`
  - `eventId`
  - `eventTitle` (For frontend preview)
  - `iat` / `exp` (Standard JWT Claims)

## 3. Validation Rules (Check-in)
- **Duplicate Entry**: The system must block re-entry.
  - If a Ticket is already marked `checkedInAt != null`, return error "Ticket already checked in".
- **Loop Prevention** (Frontend):
  - The scanner must ignore the **same** QR Code for **5 seconds** after a successful/failed read to prevent accidental loops.
- **Authenticity**:
  - The system must validate that the QR Code was generated by this system (via signature/hash validation).

## 4. Financial
- **Cost**: All events are **100% Free**.
- **Payment Gateway**: None.

## 5. Coverage & Availability
- **Geographic Reach**: The platform must support events in all 5 regions of Brazil:
  - **Norte**: AM, RR, AP, PA, TO, RO, AC
  - **Nordeste**: MA, PI, CE, RN, PB, PE, AL, SE, BA
  - **Centro-Oeste**: MT, MS, GO, DF
  - **Sudeste**: SP, RJ, ES, MG
  - **Sul**: PR, RS, SC
- **Planning Horizon**: Events are typically scheduled 6 to 8 months in advance.

## 6. Data Seeding (Development)
- **Volume**: A minimum of **15 events** must be seeded.
- **Distribution**: Events must be distributed cases across all 5 regions.
- **Timing**: All seeded events must be in the **future** (next 6-8 months) to ensure they appear in the "Upcoming" lists.
- **Localization**: All titles, descriptions, and locations must be realistic and in **PT-BR**.

